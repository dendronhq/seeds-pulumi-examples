<!DOCTYPE html>

<html lang="en-US">
<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
  
  <title>Azure Go Aks Helm - Dendron - Pulumi</title>
  

  <link
    rel="shortcut icon"
    href="https://pulumi.dendron.so/favicon.ico"
    type="image/x-icon"
  />
  <link
    rel="stylesheet"
    href="https://pulumi.dendron.so/assets/css/just-the-docs-default.css"
  />
  <script
    type="text/javascript"
    src="https://pulumi.dendron.so/assets/js/just-the-docs.js"
  ></script>
  <link
    rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.22.0/themes/prism.min.css"
  />
  <link
    rel="stylesheet"
    href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css"
    integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X"
    crossorigin="anonymous"
  />
  <script
    type="text/javascript"
    src="https://pulumi.dendron.so/assets/js/vendor/lunr.min.js"
  ></script>
  
  <meta name="viewport" content="width=device-width, initial-scale=1" />
   
  
<meta name="description" content="Dendron Vault for Pulumi Examples">
<meta name="author" content="">

<link rel="canonical" href="https://pulumi.dendron.so/notes/azure-go-aks-helm.html">

<meta property="og:type" content="article">
<meta property="og:url" content="https://pulumi.dendron.so/notes/azure-go-aks-helm.html">
<meta property="og:description" content="Dendron Vault for Pulumi Examples">
<meta property="og:image" content="https://pulumi.dendron.soundefined">

<meta name="twitter:card" content="summary">

<meta name="twitter:url" content="https://pulumi.dendron.so/notes/azure-go-aks-helm.html">
<meta name="twitter:description" content="Dendron Vault for Pulumi Examples">
<meta name="twitter:image" content="https://pulumi.dendron.soundefined">


  <meta property="og:title" content="Azure Go Aks Helm - Dendron - Pulumi" />
  <meta name="twitter:title" content="Azure Go Aks Helm - Dendron - Pulumi" />
  
</head>


<body>
    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
      <symbol id="svg-link" viewBox="0 0 24 24">
        <title>Link</title>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link">
          <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
        </svg>
      </symbol>
      <symbol id="svg-search" viewBox="0 0 24 24">
        <title>Search</title>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search">
          <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line>
        </svg>
      </symbol>
      <symbol id="svg-menu" viewBox="0 0 24 24">
        <title>Menu</title>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu">
          <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line>
        </svg>
      </symbol>
      <symbol id="svg-arrow-right" viewBox="0 0 24 24">
        <title>Expand</title>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right">
          <polyline points="9 18 15 12 9 6"></polyline>
        </svg>
      </symbol>
      <symbol id="svg-doc" viewBox="0 0 24 24">
        <title>Document</title>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file">
          <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline>
        </svg>
      </symbol>
    </svg>

    <div class="side-bar">
      <div class="site-header">
        <a href="https://pulumi.dendron.so" class="site-title lh-tight">
  Dendron - Pulumi

 </a>
        <a href="#" id="menu-button" class="site-button">
          <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg>
        </a>
      </div>

      <nav role="navigation" aria-label="Main" id="site-nav" class="site-nav">
      </nav>
      <footer class="site-footer">
        ðŸŒ± with ðŸ’• using <a href="https://www.dendron.so/"> Dendron ðŸŒ² </a>
      </footer>
    </div>
    <div class="main" id="top">
        <div id="main-header" class="main-header">
          
            <div class="search">
              <div class="search-input-wrap">
                <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search Dendron - Pulumi" aria-label="Search Dendron - Pulumi" autocomplete="off">
                <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label>
              </div>
              <div id="search-results" class="search-results"></div>
            </div>
          
          
    </div>
    <div id="main-content-wrap" class="main-content-wrap">
      
        
          <nav aria-label="Breadcrumb" class="breadcrumb-nav">
            <ol class="breadcrumb-nav-list"><li class="breadcrumb-nav-list-item"><a href="https://pulumi.dendron.so">Root</a></li><li class="breadcrumb-nav-list-item">Azure Go Aks Helm</li></ol>
          </nav>
        
      
      <div id="main-content" class="main-content" role="main">

        
        

        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css" integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" crossorigin="anonymous">
        <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
        <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js" integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI" crossorigin="anonymous"></script>

        
        <div class="alert alert-primary" role="alert">
          This page was generated from content adapted from the following <a href="#" data-html="true" data-toggle="popover" title="Attributions">sources</a>
          </a>
        </div>

        <script>
          $(function () {
            $('[data-toggle="popover"]').popover({content: `
              <ul>
              
              <li> <a href="https://github.com/pulumi/examples" target="_blank"> pulumi examples  </li>
              
              </ul>
            `})
          })
        </script>
        

        <script>
          $(function () {
            $('[data-toggle="popover"]').popover({html: true})
          })
        </script>

        

<div id="main" role="main">

  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="Azure Go Aks Helm">
    
    <meta itemprop="datePublished" content="2021-03-31T15:19:59+00:00">
    <meta itemprop="dateModified" content="2021-03-31T15:19:59+00:00">

    <div class="page__inner-wrap">

      

      <section class="page__content" itemprop="text">

        

        <p><a href="https://app.pulumi.com/new"><img src="https://get.pulumi.com/new/button.svg" alt="Deploy"></a></p>
<h1 id="azure-kubernetes-service-aks-cluster-and-helm-chart"><a aria-hidden="true" class="anchor-heading" href="#azure-kubernetes-service-aks-cluster-and-helm-chart"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>Azure Kubernetes Service (AKS) Cluster and Helm Chart</h1>
<p>This example demonstrates creating an <a href="https://docs.microsoft.com/en-us/azure/aks/">Azure Kubernetes Service (AKS)</a>
cluster and deploying a Helm Chart from <a href="https://github.com/bitnami/charts">Bitnami Helm chart repository</a>
into this cluster, all in one Pulumi program.</p>
<p>The example showcases the <a href="https://www.pulumi.com/docs/intro/cloud-providers/azure/">native Azure provider for Pulumi</a>.</p>
<h2 id="prerequisites"><a aria-hidden="true" class="anchor-heading" href="#prerequisites"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>Prerequisites</h2>
<ul>
<li>
<p>Install <a href="https://www.pulumi.com/docs/get-started/install/">Pulumi</a>.</p>
</li>
<li>
<p>Install <a href="https://golang.org">Go</a></p>
</li>
<li>
<p>We will be deploying to Azure, so you will need an Azure account. If
you do not have an account, <a href="https://azure.microsoft.com/en-us/free/">sign up for free here</a>.</p>
</li>
<li>
<p>Setup and authenticate the <a href="https://www.pulumi.com/docs/intro/cloud-providers/azure/setup/">native Azure provider for Pulumi</a>.</p>
</li>
</ul>
<h2 id="running-the-example"><a aria-hidden="true" class="anchor-heading" href="#running-the-example"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>Running the Example</h2>
<p>In this example we will provision a Kubernetes cluster running a
public Apache web server, verify we can access it, and clean up when
done.</p>
<ol>
<li>
<p>Get the code:</p>
<pre class="language-bash"><code class="language-bash">$ <span class="token function">git</span> clone git@github.com:pulumi/examples.git
$ <span class="token builtin class-name">cd</span> examples/azure-go-aks-helm
</code></pre>
</li>
<li>
<p>Restore dependencies and build:</p>
<pre class="language-bash"><code class="language-bash">$ go build
</code></pre>
</li>
<li>
<p>Create a new stack, which is an isolated deployment target for this example:</p>
<pre class="language-bash"><code class="language-bash">$ pulumi stack init
</code></pre>
</li>
<li>
<p>Set the required configuration variables for this program:</p>
<pre class="language-bash"><code class="language-bash">$ pulumi config <span class="token builtin class-name">set</span> azure-native:location westus2
</code></pre>
</li>
<li>
<p>Deploy everything with the <code>pulumi up</code> command. This provisions
all the Azure resources necessary, including an Active Directory
service principal, AKS cluster, and then deploys the Apache Helm
Chart, all in a single gesture (takes 5-10 min):</p>
<pre class="language-bash"><code class="language-bash">$ pulumi up
</code></pre>
</li>
<li>
<p>Now your cluster and Apache server are ready. Several output
variables will be printed, including your cluster name
(<code>clusterName</code>), Kubernetes config (<code>kubeconfig</code>) and server IP
address (<code>apacheServiceIP</code>).</p>
<p>Using these output variables, you may access your Apache server:</p>
<pre class="language-bash"><code class="language-bash">$ <span class="token function">curl</span> <span class="token variable"><span class="token variable">$(</span>pulumi stack output apacheServiceIP<span class="token variable">)</span></span>
<span class="token operator">&#x3C;</span>html<span class="token operator">></span><span class="token operator">&#x3C;</span>body<span class="token operator">></span><span class="token operator">&#x3C;</span>h<span class="token operator"><span class="token file-descriptor important">1</span>></span>It works<span class="token operator">!</span><span class="token operator">&#x3C;</span>/h<span class="token operator"><span class="token file-descriptor important">1</span>></span><span class="token operator">&#x3C;</span>/body<span class="token operator">></span><span class="token operator">&#x3C;</span>/html<span class="token operator">></span>
</code></pre>
<p>And you may also configure your <code>kubectl</code> client using the
<code>kubeConfig</code> configuration:</p>
<pre class="language-bash"><code class="language-bash">$ pulumi stack output kubeconfig --show-secrets <span class="token operator">></span> kubeconfig.yaml
$ <span class="token assign-left variable">KUBECONFIG</span><span class="token operator">=</span>./kubeconfig.yaml kubectl get <span class="token function">service</span>

NAME           TYPE           CLUSTER-IP     EXTERNAL-IP      PORT<span class="token punctuation">(</span>S<span class="token punctuation">)</span>                      AGE
apache-chart   LoadBalancer   <span class="token number">10.0</span>.154.121   <span class="token number">40.125</span>.100.104   <span class="token number">80</span>:30472/TCP,443:30364/TCP   8m
kubernetes     ClusterIP      <span class="token number">10.0</span>.0.1       <span class="token operator">&#x3C;</span>none<span class="token operator">></span>           <span class="token number">443</span>/TCP                      8m
</code></pre>
</li>
<li>
<p>At this point, you have a running cluster. Feel free to modify
your program, and run <code>pulumi up</code> to redeploy changes. The Pulumi
CLI automatically detects what has changed and makes the minimal
edits necessary to accomplish these changes. This could be
altering the existing chart, adding new Azure or Kubernetes
resources, or anything, really.</p>
<p>TIP: if you make changes to the example code outside of an IDE,
run the Go compiler after every change:</p>
<pre class="language-bash"><code class="language-bash">$ go build
</code></pre>
</li>
<li>
<p>Once you are done, you can destroy all of the resources, and the
stack:</p>
<pre class="language-bash"><code class="language-bash">$ pulumi destroy
$ pulumi stack <span class="token function">rm</span>
$ <span class="token function">rm</span> kubeconfig.yaml
</code></pre>
</li>
</ol>
<hr>
<h2 id="imported-assets"><a aria-hidden="true" class="anchor-heading" href="#imported-assets"><svg aria-hidden="true" viewBox="0 0 16 16"><use xlink:href="#svg-link"></use></svg></a>Imported Assets</h2>
<ul>
<li><a href="/assets/pulumi.yaml">Pulumi.yaml</a></li>
<li><a href="/assets/cluster.go">cluster.go</a></li>
<li><a href="/assets/config.go">config.go</a></li>
<li><a href="/assets/go.mod">go.mod</a></li>
<li><a href="/assets/go.sum">go.sum</a></li>
<li><a href="/assets/main.go">main.go</a></li>
</ul><span id="navId" data="azure-go-aks-helm"></span>

                
      </section>

      
    </div>

    
  </article>

  
  
</div>


        
          <hr>
          <footer>
            
            

            
                
                  <p class="text-small text-grey-dk-000 mb-0">
                    <a href="https://github.com/pulumi/examples/edit/master/azure-go-aks-helm/README.md" id="edit-this-page">Edit this page on GitHub</a>
                  </p>
                
              </div>
          </footer>
        
    </div>
</div>


  

  <div class="search-overlay"></div>

</div>
</body>
</html>
